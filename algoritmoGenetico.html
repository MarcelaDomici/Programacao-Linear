<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algoritmos Genéticos - Programação Linear</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="CSS/algoritmoGenetico.css">
</head>

<body class="min-h-screen flex items-center justify-center p-4">
    <div class="w-full max-w-4xl mx-auto">
        <div class="text-center mb-10">
            <h1 class="text-3xl font-bold text-gray-800">Algoritmos Genéticos</h1>
            <p class="text-gray-600 mt-2">Configure os parâmetros para execução do algoritmo</p>
        </div>
        <div class="bg-white rounded-xl shadow-md p-6 mb-8 card-hover">

            <form class="space-y-6">
                <div class="flex flex-col gap-6">
                    <!-- Tamanho do Problema -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2" for="tamanho">
                            <i class="fas fa-expand-alt mr-2 text-blue-500"></i>Tamanho do Problema
                        </label>
                        <div class="relative">
                            <input type="number" id="tamanho"
                                class="input-field w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                placeholder="Digite o tamanho">
                        </div>
                    </div>
                </div>

                <!-- Parâmetros Genéticos -->
                <div class="space-y-5">
                    <label class="block text-sm font-medium text-gray-700 mb-2" for="tamanho">
                        <i class="fas fa-project-diagram mr-2 text-blue-500"></i>Parâmetros Genéticos
                    </label>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                        <div>
                            <label for="tp" class="block text-sm font-medium text-gray-700 mb-2">
                                Tamanho da População (TP)
                            </label>
                            <input type="number" id="tp" 
                                class="input-field w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        
                        <div>
                            <label for="tc" class="block text-sm font-medium text-gray-700 mb-2">
                                Taxa de Cruzamento (TC)
                            </label>
                            <div class="flex items-center">
                                <input type="number" id="tc" 
                                    class="input-field w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                        
                        <div>
                            <label for="tm" class="block text-sm font-medium text-gray-700 mb-2">
                                Taxa de Mutação (TM)
                            </label>
                            <div class="flex items-center">
                                <input type="number" id="tm"
                                    class="input-field w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                        
                        <div>
                            <label for="ig" class="block text-sm font-medium text-gray-700 mb-2">
                                Intervalo de Geração (IG)
                            </label>
                            <input type="number" id="ig" 
                                class="input-field w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        
                        <div>
                            <label for="ng" class="block text-sm font-medium text-gray-700 mb-2">
                                Número de Gerações (NG)
                            </label>
                            <input type="number" id="ng" 
                                class="input-field w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>
                
                <!-- Gerar Problema -->
                <div>
                    <button type="button"
                        class="w-full flex justify-between items-center px-4 py-3 bg-gray-50 hover:bg-gray-100 border border-gray-300 rounded-lg transition-all"
                        id="btn-gerarProblema">
                        <span class="text-sm font-medium text-gray-700">
                            <i class="fas fa-cog mr-2 text-blue-500"></i>Solução Inicial
                        </span>
                        <i class="fas fa-chevron-right text-gray-500"></i>
                    </button>
                </div>
                <!-- Botão Executar -->
                <div class="pt-4">
                    <button id="btn-executar" type="button" class="w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 rounded-lg text-white font-medium 
                                transition-all flex items-center justify-center shadow-md hover:shadow-lg">
                        <i class="fas fa-play-circle mr-2"></i>Executar
                    </button>
                </div>
            </form>

            <!-- Botão Voltar para o Menu -->
            <div class="pt-6">
                <a href="menu.html" class="w-full py-3 px-4 bg-gray-600 hover:bg-gray-700 rounded-lg text-white font-medium 
                        transition-all flex items-center justify-center shadow-md hover:shadow-lg">
                    <i class="fas fa-arrow-left mr-2"></i>Voltar para a Página Inicial
                </a>
            </div>
        </div>

        <!-- Área para informações adicionais -->
        <div class="bg-white rounded-xl shadow-md p-6 card-hover" id="resultadoContainer">
        </div>
        </div>

    </div>
<script>
    document.getElementById("btn-gerarProblema").addEventListener("click", async () => {
    const response = await fetch(`/api/gerar_escala?tipo=A&funcs=3`);
    const data = await response.json();

    const resultadoDiv = document.getElementById("resultadoContainer");
    resultadoDiv.innerHTML = `
        <h2 class="text-xl font-bold mb-4">Solução Inicial</h2>
        <p><strong>Avaliação:</strong> ${data.avaliacao}</p>
        <pre class="bg-gray-100 p-4 rounded">${JSON.stringify(data.escala, null, 2)}</pre>
    `;
});

document.getElementById("btn-executar").addEventListener("click", async () => {
    // pegar valores dos inputs
    const n = document.getElementById("tamanho").value || 30;
    const tp = document.getElementById("tp").value || 5;
    const tc = document.getElementById("tc").value || 0.7;
    const tm = document.getElementById("tm").value || 0.1;
    const ng = document.getElementById("ng").value || 20;

    try {
        // chamada ao endpoint FastAPI
        const response = await fetch(`/api/algoritmo_genetico?n=${n}&tp=${tp}&ng=${ng}&tm=${tm}&tc=${tc}`);
        const data = await response.json();

        // mostrar resultado no container
        const resultadoDiv = document.getElementById("resultadoContainer");
        resultadoDiv.innerHTML = `
            <h2 class="text-xl font-bold mb-4">Resultado do Algoritmo Genético</h2>
            <p><strong>Avaliação:</strong> ${data.avaliacao}</p>
            <p><strong>Melhor indivíduo:</strong></p>
            <pre class="bg-gray-100 p-4 rounded">${JSON.stringify(data.melhor_individuo, null, 2)}</pre>
        `;
    } catch (error) {
        alert("Erro ao executar o algoritmo genético: " + error);
    }
});
</script>


</body>
</html>